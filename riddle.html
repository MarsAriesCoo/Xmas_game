<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>è–èª• 51 å®®æ ¼çŒœè¬ç³»çµ± ğŸ„</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: "Microsoft JhengHei", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: radial-gradient(circle at top, #145c3a 0, #041b12 55%, #020b07 100%);
      color: #fff;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    header {
      background: #c1121f;
      text-align: center;
      padding: 16px 8px;
      font-size: 30px;
      font-weight: bold;
      letter-spacing: 2px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.45);
    }
    main {
      flex: 1;
      max-width: 1200px;
      margin: 20px auto;
      padding: 0 16px 16px;
      display: flex;
      flex-direction: column;
      align-items: stretch;
    }
    .view { display: none; }
    .view.active { display: block; }
    .section-title {
      font-size: 22px;
      margin-bottom: 10px;
      text-align: center;
    }
    .grid-wrapper {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      margin-top: 10px;
    }
    .grid-row {
      display: flex;
      gap: 10px;
      justify-content: center;
      flex-wrap: nowrap;
    }
    .grid-btn {
      min-width: 110px;
      max-width: 140px;
      padding: 16px 8px;
      border-radius: 14px;
      border: none;
      font-size: 16px;
      font-weight: 600;
      background: #145c3a;
      color: #fff;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(0,0,0,0.4);
      transition: transform 0.08s ease, box-shadow 0.08s ease, background 0.12s ease;
      white-space: normal;
    }
    .grid-btn:hover { background: #1b7a4e; }
    .grid-btn:active {
      transform: translateY(1px) scale(0.97);
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
    }
    .grid-btn.used {
      background: #109674;
      color: #051510;
    }
    .grid-btn.empty {
      background: rgba(255,255,255,0.06);
      color: rgba(255,255,255,0.45);
      cursor: default;
      box-shadow: none;
    }
    .center-row {
      display: flex;
      justify-content: center;
      margin-top: 18px;
    }
    .btn {
      padding: 10px 18px;
      border-radius: 999px;
      border: none;
      font-size: 16px;
      cursor: pointer;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      transition: transform 0.08s ease, box-shadow 0.08s ease, background 0.12s ease;
    }
    .btn:active {
      transform: translateY(1px) scale(0.98);
      box-shadow: none;
    }
    .btn-red {
      background: #c1121f;
      color: #fff;
      box-shadow: 0 3px 10px rgba(0,0,0,0.35);
    }
    .btn-red:hover { background: #a10e1a; }
    .btn-ghost {
      background: transparent;
      color: #fff;
      border: 1px solid rgba(255,255,255,0.4);
    }
    .btn-ghost:hover { background: rgba(255,255,255,0.08); }

    .card {
      background: rgba(10, 55, 39, 0.96);
      border-radius: 20px;
      border: 2px solid #c1121f;
      padding: 22px 24px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.48);
      margin-bottom: 18px;
    }
    .card-title {
      font-size: 24px;
      margin-bottom: 16px;
      text-align: center;
    }
    .question-text,
    .answer-text {
      font-size: 24px;
      line-height: 1.7;
      text-align: center;
      white-space: pre-wrap;
    }
    .answer-text { color: #ffdd33; }
    .qa-controls {
      display: flex;
      justify-content: center;
      gap: 12px;
      margin: 14px 0 18px;
      flex-wrap: wrap;
    }
    dialog {
      border: none;
      border-radius: 18px;
      padding: 18px 20px;
      max-width: 480px;
      width: 90%;
      background: #123524;
      color: #fff;
      box-shadow: 0 10px 30px rgba(0,0,0,0.6);
    }
    dialog::backdrop { background: rgba(0,0,0,0.6); }
    .field-group { margin-bottom: 10px; }
    .field-group label {
      font-size: 16px;
      display: block;
      margin-bottom: 4px;
    }
    .field-group input,
    .field-group textarea {
      width: 100%;
      padding: 8px 10px;
      font-size: 16px;
      border-radius: 10px;
      border: 1px solid #277454;
      background: #0c291d;
      color: #fff;
      resize: vertical;
      min-height: 80px;
    }
    .field-group input { min-height: auto; }
    .dialog-actions {
      display: flex;
      justify-content: flex-end;
      gap: 8px;
      margin-top: 10px;
    }
    footer {
      text-align: center;
      font-size: 18px;
      padding: 10px 0 16px;
      color: #ffdd55;
    }
  </style>
</head>
<body>
  <header>
    ğŸ„ è–èª• 51 å®®æ ¼çŒœè¬å°åŠ‡å ´ ğŸ…
  </header>

  <main>
    <!-- ä¸»é ï¼š51 å®®æ ¼ -->
    <section id="homeView" class="view active">
      <div class="section-title">é»é¸ä¸€æ ¼é€²å…¥è¬é¡Œï¼š</div>
      <div class="grid-wrapper" id="gridWrapper"></div>
      <div class="center-row">
        <button class="btn btn-red" id="btnAddRiddle">â• æ–°å¢è¬é¡Œ</button>
      </div>
    </section>

    <!-- é¡Œç›®é  -->
    <section id="qaView" class="view">
      <div class="card">
        <div class="card-title" id="qaTitle">ğŸ„ è¬é¡Œå…§å®¹ ğŸ„</div>
        <div class="question-text" id="questionText">ï¼ˆè«‹å…ˆå¾ 51 å®®æ ¼é¸æ“‡ä¸€é¡Œï¼‰</div>
      </div>

      <div class="qa-controls">
        <button class="btn btn-red" id="btnShowAnswer">ğŸ é¡¯ç¤ºè¬åº•</button>
        <button class="btn btn-ghost" id="btnDeleteRiddle">ğŸ—‘ åˆªé™¤æ­¤é¡Œ</button>
      </div>

      <div class="card">
        <div class="card-title">ğŸ è¬åº• ğŸ</div>
        <div class="answer-text" id="answerText">ï¼ˆå°šæœªé¡¯ç¤ºç­”æ¡ˆï¼Œå…ˆå’Œå¤§å®¶çŒœçŒœçœ‹ ğŸ˜ï¼‰</div>
      </div>

      <div class="center-row">
        <button class="btn btn-red" id="btnBackHome">â¬… å›åˆ° 51 å®®æ ¼</button>
      </div>
    </section>
  </main>

  <footer>
    ç­”å°ä¹Ÿå¥½ï¼Œç­”éŒ¯ä¹Ÿå¥½ï¼Œå¤§å®¶ä¸€èµ·ç¬‘è‘—éè–èª• ğŸ…
  </footer>

  <!-- æ–°å¢è¬é¡Œ Dialog -->
  <dialog id="addDialog">
    <form method="dialog" id="addForm">
      <h3 style="margin-top:0;margin-bottom:8px;">æ–°å¢è¬é¡Œï¼ˆä¸»è¾¦ç”¨ï¼‰</h3>
      <div class="field-group">
        <label for="titleInput">é¡Œç›®æ¨™é¡Œï¼š</label>
        <input id="titleInput" type="text" placeholder="ä¾‹å¦‚ï¼šç¬¬4é¡Œï¼è–èª•ç‰¹åˆ¥é¡Œ" />
      </div>
      <div class="field-group">
        <label for="questionInput">è¬é¡Œå…§å®¹ï¼š</label>
        <textarea id="questionInput" placeholder="è¼¸å…¥è¬é¡Œå…§å®¹"></textarea>
      </div>
      <div class="field-group">
        <label for="answerInput">è¬åº•ï¼š</label>
        <textarea id="answerInput" placeholder="è¼¸å…¥è¬åº•"></textarea>
      </div>
      <div class="dialog-actions">
        <button class="btn btn-ghost" type="button" id="btnCancelAdd">å–æ¶ˆ</button>
        <button class="btn btn-red" type="submit">åŠ å…¥</button>
      </div>
    </form>
  </dialog>

  <script>
    const initialRiddles = [
      {
        title: "ç¬¬1é¡Œ",
        question: "æ—©ä¸Šå››æ¢è…¿ï¼Œä¸­åˆå…©æ¢è…¿ï¼Œæ™šä¸Šä¸‰æ¢è…¿ï¼Œè«‹å•æ˜¯ä»€éº¼ï¼Ÿ",
        answer: "äººï¼ˆå¬°å…’çˆ¬è¡Œã€æˆäººèµ°è·¯ã€è€äººæ‹„æ–ï¼‰",
        used: false,
      },
      {
        title: "ç¬¬2é¡Œ",
        question: "ä»€éº¼æ±è¥¿è¶Šæ´—è¶Šé«’ï¼Ÿ",
        answer: "æ°´",
        used: false,
      },
      {
        title: "ç¬¬3é¡Œ",
        question: "èº«ç©¿ç¶ è¡£è£³ï¼Œè‚šè£¡æ°´æ±ªæ±ªï¼Œç”Ÿçš„å­å…’å¤šï¼Œå€‹å€‹é»‘å¿ƒè…¸ã€‚æ˜¯ä»€éº¼ï¼Ÿ",
        answer: "è¥¿ç“œ",
        used: false,
      },
    ];

    const rowLayout = [6, 7, 8, 9, 8, 7, 6];
    const MAX_SLOTS = rowLayout.reduce((a, b) => a + b, 0);

    const homeView = document.getElementById("homeView");
    const qaView = document.getElementById("qaView");
    const gridWrapper = document.getElementById("gridWrapper");
    const btnAddRiddle = document.getElementById("btnAddRiddle");

    const qaTitle = document.getElementById("qaTitle");
    const questionText = document.getElementById("questionText");
    const answerText = document.getElementById("answerText");
    const btnShowAnswer = document.getElementById("btnShowAnswer");
    const btnDeleteRiddle = document.getElementById("btnDeleteRiddle");
    const btnBackHome = document.getElementById("btnBackHome");

    const addDialog = document.getElementById("addDialog");
    const addForm = document.getElementById("addForm");
    const titleInput = document.getElementById("titleInput");
    const questionInput = document.getElementById("questionInput");
    const answerInput = document.getElementById("answerInput");
    const btnCancelAdd = document.getElementById("btnCancelAdd");

    let riddles = [...initialRiddles];
    let selectedIndex = null;

    function showHomeView() {
      homeView.classList.add("active");
      qaView.classList.remove("active");
    }

    function showQAView() {
      qaView.classList.add("active");
      homeView.classList.remove("active");
    }

    function renderGrid() {
      gridWrapper.innerHTML = "";
      let idx = 0;
      const total = riddles.length;

      for (const count of rowLayout) {
        const rowDiv = document.createElement("div");
        rowDiv.className = "grid-row";

        for (let i = 0; i < count; i++) {
          const btn = document.createElement("button");
          btn.className = "grid-btn";

          if (idx < total) {
            const r = riddles[idx];
            btn.textContent = r.title || `é¡Œç›® ${idx + 1}`;
            if (r.used) btn.classList.add("used");
            btn.addEventListener("click", () => openRiddle(idx));
          } else {
            btn.textContent = "ï¼ˆç©ºï¼‰";
            btn.classList.add("empty");
          }

          rowDiv.appendChild(btn);
          idx++;
        }
        gridWrapper.appendChild(rowDiv);
      }
    }

    function openRiddle(index) {
      if (index >= riddles.length) return;
      selectedIndex = index;
      const r = riddles[index];

      qaTitle.textContent = r.title || "è¬é¡Œ";
      questionText.textContent = r.question || "";
      answerText.textContent = "ï¼ˆå°šæœªé¡¯ç¤ºç­”æ¡ˆï¼Œå…ˆå’Œå¤§å®¶çŒœçŒœçœ‹ ğŸ˜ï¼‰";
      showQAView();
    }

    function showAnswer() {
      if (selectedIndex === null || selectedIndex >= riddles.length) {
        alert("è«‹å…ˆå¾ 51 å®®æ ¼é¸ä¸€é¡Œ");
        return;
      }
      const r = riddles[selectedIndex];
      answerText.textContent = r.answer || "";
      r.used = true;
      renderGrid();
    }

    function deleteCurrentRiddle() {
      if (selectedIndex === null || selectedIndex >= riddles.length) {
        alert("ç›®å‰æ²’æœ‰é¸ä¸­çš„é¡Œç›®");
        return;
      }
      const r = riddles[selectedIndex];
      const ok = confirm(`ç¢ºå®šè¦åˆªé™¤ã€Œ${r.title || "é€™ä¸€é¡Œ"}ã€å—ï¼Ÿ`);
      if (!ok) return;

      riddles.splice(selectedIndex, 1);
      selectedIndex = null;
      showHomeView();
      renderGrid();
    }

    function openAddDialog() {
      if (riddles.length >= MAX_SLOTS) {
        alert("å·²é” 51 é¡Œä¸Šé™ï¼Œç„¡æ³•å†æ–°å¢ã€‚");
        return;
      }
      titleInput.value = "";
      questionInput.value = "";
      answerInput.value = "";
      addDialog.showModal();
    }

    addForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const title = titleInput.value.trim();
      const question = questionInput.value.trim();
      const answer = answerInput.value.trim();

      if (!title || !question || !answer) {
        alert("æ¨™é¡Œã€è¬é¡Œå…§å®¹ã€è¬åº•éƒ½è¦å¡«å¯«å–”ï¼");
        return;
      }

      riddles.push({ title, question, answer, used: false });
      addDialog.close();
      renderGrid();
    });

    btnCancelAdd.addEventListener("click", () => addDialog.close());

    btnAddRiddle.addEventListener("click", openAddDialog);
    btnShowAnswer.addEventListener("click", showAnswer);
    btnDeleteRiddle.addEventListener("click", deleteCurrentRiddle);
    btnBackHome.addEventListener("click", () => {
      showHomeView();
      renderGrid();
    });

    renderGrid();
  </script>
</body>
</html>
